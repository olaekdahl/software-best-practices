# OWASP Top 10 â†’ Python Mapping

| **OWASP Top 10 (2021)**                             | **Python Example / Risk Area**                                                                    | **Mitigation / Best Practice**                                                                                                                          |
| --------------------------------------------------- | ------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **A01: Broken Access Control**                      | Exposing admin endpoints without auth, e.g.:<br>`@app.route('/admin')` without `@login_required`  | Use `Flask-Login`, `FastAPI Depends(get_current_user)`, enforce RBAC/ABAC; test using `pytest` with unauthorized user cases.                            |
| **A02: Cryptographic Failures**                     | Using weak or no encryption:<br>`hashlib.md5(password.encode())`                                  | Use `bcrypt`, `argon2`, or `cryptography.fernet` for secure password hashing and encryption. Never store plaintext.                                     |
| **A03: Injection**                                  | SQL injection in raw queries:<br>`cursor.execute("SELECT * FROM users WHERE name = '%s'" % name)` | Use parameterized queries via `sqlite3`, SQLAlchemy ORM, or query builders. Validate all user input with `pydantic` or `marshmallow`.                   |
| **A04: Insecure Design**                            | Missing limits or validation logic:<br>no rate limit on login route                               | Add throttling (`Flask-Limiter`, `FastAPI-limiter`), define security requirements early (threat modeling).                                              |
| **A05: Security Misconfiguration**                  | Debug mode enabled:<br>`app.run(debug=True)`                                                      | Disable debug in production. Use `.env` config, secure headers (`Flask-Talisman`, `starlette.middleware.httpsredirect`).                                |
| **A06: Vulnerable and Outdated Components**         | Using unpatched dependencies in `requirements.txt`                                                | Automate scanning (`pip-audit`, `safety`, `dependabot`). Pin versions and run CI security scans.                                                        |
| **A07: Identification and Authentication Failures** | Custom auth logic instead of a proven lib                                                         | Use proven frameworks: `Flask-JWT-Extended`, `Authlib`, or OAuth2 middleware. Enforce strong password and session policies.                             |
| **A08: Software and Data Integrity Failures**       | Unsigned dependency installation via `pip install http://example.com/pkg.zip`                     | Use hashes in `requirements.txt` (`--require-hashes`), verify signatures (e.g., `pip install --verify`). Sign release artifacts with `Cosign` or `GPG`. |
| **A09: Security Logging and Monitoring Failures**   | Only using `print()` instead of logs                                                              | Use `logging` with proper levels, central log aggregation. Add alerting for repeated failed logins.                                                     |
| **A10: Server-Side Request Forgery (SSRF)**         | User-provided URL fetched directly:<br>`requests.get(user_input_url)`                             | Validate/whitelist domains before requests. Use `urllib.parse` to restrict internal IPs and metadata endpoints.                                         |
